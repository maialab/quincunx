<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PGS scoring file • quincunx</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="PGS scoring file">
<meta property="og:description" content="quincunx">
<meta property="og:image" content="https://maialab.org/quincunx/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">quincunx</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="divider">
    </li>
<li class="dropdown-header">PGS Catalog Concepts</li>
    <li>
      <a href="../articles/identifiers.html">Identifiers</a>
    </li>
    <li>
      <a href="../articles/pgs-construction-process.html">PGS Construction Process and Stages</a>
    </li>
    <li>
      <a href="../articles/cohorts-samples-sample-sets.html">Cohorts, Samples and Sample Sets</a>
    </li>
    <li class="divider">
    </li>
<li class="dropdown-header">Getting PGS Catalog Data</li>
    <li>
      <a href="../articles/getting-pgs-scores.html">Getting PGS Scores</a>
    </li>
    <li>
      <a href="../articles/getting-pgs-publications.html">Getting PGS Publications</a>
    </li>
    <li>
      <a href="../articles/getting-pgs-sample-sets.html">Getting PGS Sample Sets</a>
    </li>
    <li>
      <a href="../articles/getting-pgs-performance-metrics.html">Getting PGS Performance Metrics</a>
    </li>
    <li>
      <a href="../articles/getting-traits.html">Getting Traits</a>
    </li>
    <li>
      <a href="../articles/getting-cohorts.html">Getting Cohorts</a>
    </li>
    <li>
      <a href="../articles/getting-releases.html">PGS Catalog Releases</a>
    </li>
    <li>
      <a href="../articles/pgs-scoring-file.html">PGS scoring file</a>
    </li>
    <li class="divider">
    </li>
<li class="dropdown-header">Wrangling PGS Catalog Data</li>
    <li>
      <a href="../articles/pgs-cat-ent-subsetting.html">PGS Catalog Entity Subsetting</a>
    </li>
    <li class="divider">
    </li>
<li class="dropdown-header">Case Studies</li>
    <li>
      <a href="../articles/risk-strat-brs-patients.html">Risk of Brugada syndrome patients</a>
    </li>
    <li>
      <a href="../articles/pgs-scores-mavaddat.html">Exploring PGS scores by Mavaddat et al. (2018)</a>
    </li>
    <li class="divider">
    </li>
<li>
      <a href="../articles/index.html">More articles...</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/maialab/quincunx/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="pgs-scoring-file_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>PGS scoring file</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/maialab/quincunx/blob/HEAD/vignettes/pgs-scoring-file.Rmd" class="external-link"><code>vignettes/pgs-scoring-file.Rmd</code></a></small>
      <div class="hidden name"><code>pgs-scoring-file.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>PGS scoring files are the files provided by the PGS Catalog that allow you to compute polygenic scores for your samples. These files are hosted at the PGS Catalog FTP server: <a href="http://ftp.ebi.ac.uk/pub/databases/spot/pgs/scores/" class="external-link">http://ftp.ebi.ac.uk/pub/databases/spot/pgs/scores/</a>. They are labelled by their respective PGS Score ID (e.g. <code>PGS000001.txt.gz</code>).</p>
<p>Essentially, each scoring file contains variant identification, effect alleles and respective score weights. The file is formatted to be a gzipped tab-delimited text file. The file starts with an header that contains brief metadata about the score.</p>
<p><img src="../reference/figures/pgs_scoring_file.svg" width="100%"></p>
</div>
<div class="section level2">
<h2 id="getting-pgs-scoring-files">Getting PGS scoring files<a class="anchor" aria-label="anchor" href="#getting-pgs-scoring-files"></a>
</h2>
<p>To get PGS scoring files you may either download them directly from the FTP server yourself or use the quincunx function <code><a href="../reference/read_scoring_file.html">read_scoring_file()</a></code>. This function automatically downloads, unzips and reads both the header and the data as a data frame into R. Let’s look at an example: polygenic score “PGS000655”. You can use directly the PGS score ID as the argument to the <code>source</code> parameter in the function <code><a href="../reference/read_scoring_file.html">read_scoring_file()</a></code>, and it will translate it to the corresponding URL, download the file and import the data as data frame with appropriate data types.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_pgs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_scoring_file.html">read_scoring_file</a></span><span class="op">(</span>source <span class="op">=</span> <span class="st">"PGS000655"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">my_pgs</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">my_pgs</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "PGS000655"</span></span></code></pre></div>
<p>The returned object of <code><a href="../reference/read_scoring_file.html">read_scoring_file()</a></code> is a list of lists. The outer list runs (potentially) over several PGS IDs if you asked for more than one. So we start by extracting the first (and in this case only) score by name:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">PGS000655</span> <span class="op">&lt;-</span> <span class="va">my_pgs</span><span class="op">[[</span><span class="st">'PGS000655'</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">PGS000655</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "metadata" "data"</span></span></code></pre></div>
<p>Now, each inner list comprises two elements: <code>metadata</code> and <code>data</code>. The metadata part contains the information retrieved from the initial comment block of the file:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">PGS000655</span><span class="op">$</span><span class="va">metadata</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 1</span></span>
<span><span class="co">#&gt; Columns: 10</span></span>
<span><span class="co">#&gt; $ pgs_id             <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "PGS000655"</span></span>
<span><span class="co">#&gt; $ pgs_name           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "NAFLD-10"</span></span>
<span><span class="co">#&gt; $ reported_trait     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Non-alcoholic fatty liver disease"</span></span>
<span><span class="co">#&gt; $ mapped_trait       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "non-alcoholic fatty liver disease"</span></span>
<span><span class="co">#&gt; $ efo_trait          <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "EFO_0003095"</span></span>
<span><span class="co">#&gt; $ genome_build       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "GRCh37"</span></span>
<span><span class="co">#&gt; $ weight_type        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "beta"</span></span>
<span><span class="co">#&gt; $ number_of_variants <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 10</span></span>
<span><span class="co">#&gt; $ pgp_id             <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "PGP000119"</span></span>
<span><span class="co">#&gt; $ citation           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Namjou B et al. BMC Med (2019). doi:10.1186/s12916…</span></span></code></pre></div>
<p>From the metadata we can see that this score is for the trait <em>Non-alcoholic fatty liver disease</em>, and that it is composed of 10 variants. Remember that you can retrieve more metadata information about this score by using <code>get_scores('PGS000655')</code> or <code>get_performance_metrics('PGS000655')</code>.</p>
<p>The data element contains the actual relevant information for calculating scores:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">PGS000655</span><span class="op">$</span><span class="va">data</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 10 × 4</span></span></span>
<span><span class="co">#&gt;    rsID       effect_allele effect_weight    OR</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                 <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> rs1260326  T                    0.057<span style="text-decoration: underline;">1</span>  1.14</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> rs780094   T                    0.061<span style="text-decoration: underline;">1</span>  1.15</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> rs2954021  G                   -<span style="color: #BB0000;">0.098</span><span style="color: #BB0000; text-decoration: underline;">0</span>  0.8 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> rs4808199  A                    0.086<span style="text-decoration: underline;">8</span>  1.22</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> rs58542926 T                    0.089<span style="text-decoration: underline;">9</span>  1.23</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> rs738409   G                    0.253   1.79</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> rs3747207  A                    0.250   1.78</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> rs2294915  T                    0.243   1.75</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> rs1227756  G                    0.026<span style="text-decoration: underline;">1</span>  1.06</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> rs2294918  A                   -<span style="color: #BB0000;">0.114</span>   0.78</span></span></code></pre></div>
<p>The minimal information for calculating scores are: variant identification information, and its effect allele, as well as the corresponding score weight. Currently, the PGS Catalog project, identifies a variant by either its rsID (column <code>rsID</code>), or by its genomic position (columns <code>chr_name</code> and <code>chr_position</code>). The effect allele and the score weight are given in the columns <code>effect_allele</code> and <code>effect_weight</code>, respectively.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">PGS000655</span><span class="op">$</span><span class="va">data</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'rsID'</span>, <span class="st">'effect_allele'</span>, <span class="st">'effect_weight'</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 10 × 3</span></span></span>
<span><span class="co">#&gt;    rsID       effect_allele effect_weight</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                 <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> rs1260326  T                    0.057<span style="text-decoration: underline;">1</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> rs780094   T                    0.061<span style="text-decoration: underline;">1</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> rs2954021  G                   -<span style="color: #BB0000;">0.098</span><span style="color: #BB0000; text-decoration: underline;">0</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> rs4808199  A                    0.086<span style="text-decoration: underline;">8</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> rs58542926 T                    0.089<span style="text-decoration: underline;">9</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> rs738409   G                    0.253 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> rs3747207  A                    0.250 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> rs2294915  T                    0.243 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> rs1227756  G                    0.026<span style="text-decoration: underline;">1</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> rs2294918  A                   -<span style="color: #BB0000;">0.114</span></span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="note-about-large-pgs-files">Note about large PGS files<a class="anchor" aria-label="anchor" href="#note-about-large-pgs-files"></a>
</h2>
<p>Please note that number of variants comprising PGS scores can vary wildly. In the example above (<code>"PGS000655"</code>) we provided a very small example. Other scores may be composed of millions of variants, e.g., <code>"PGS000013"</code>. Reading this scoring files directly to memory may take up a substantial amount of resources (in the order of Gigabytes). So to prevent stalling your computer while reading these files we recommend to read in only the metadata, as this can be done efficiently. As the number of variants is indicated in the metadata then you can decide whether to read in all the information or not.</p>
<p>To read only the metadata set the parameter <code>metadata_only</code> to <code>TRUE</code>:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_big_scoring_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_scoring_file.html">read_scoring_file</a></span><span class="op">(</span>source <span class="op">=</span> <span class="st">"PGS000013"</span>, metadata_only <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">my_big_scoring_file</span><span class="op">[[</span><span class="st">'PGS000013'</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">metadata</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 1</span></span>
<span><span class="co">#&gt; Columns: 10</span></span>
<span><span class="co">#&gt; $ pgs_id             <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "PGS000013"</span></span>
<span><span class="co">#&gt; $ pgs_name           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "GPS_CAD"</span></span>
<span><span class="co">#&gt; $ reported_trait     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Coronary artery disease"</span></span>
<span><span class="co">#&gt; $ mapped_trait       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "coronary artery disease"</span></span>
<span><span class="co">#&gt; $ efo_trait          <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "EFO_0001645"</span></span>
<span><span class="co">#&gt; $ genome_build       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "hg19"</span></span>
<span><span class="co">#&gt; $ weight_type        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> NA</span></span>
<span><span class="co">#&gt; $ number_of_variants <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 6630150</span></span>
<span><span class="co">#&gt; $ pgp_id             <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "PGP000006"</span></span>
<span><span class="co">#&gt; $ citation           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Khera AV et al. Nat Genet (2018). doi:10.1038/s415…</span></span></code></pre></div>
<p>As can be seen from the variable <code>number_of_variants</code>, the number of variants is greater than 6 million. This means that reading this PGS scoring file has these many rows which can make it burdensome on some computers.</p>
<p>To know how many variants are included in every score, you can take advantage of the <code><a href="../reference/get_scores.html">get_scores()</a></code> function:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># all_scores &lt;- get_scores()</span></span>
<span><span class="co"># all_scores@scores[c('pgs_id', 'n_variants')]</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="pgs-scoring-file-format">PGS scoring file format<a class="anchor" aria-label="anchor" href="#pgs-scoring-file-format"></a>
</h2>
<p>Each scoring file contains variant identification, effect alleles and respective score weights. The file is formatted as a gzipped tab-delimited text file, with a header containing brief metadata about the score.</p>
<div class="section level3">
<h3 id="header">Header<a class="anchor" aria-label="anchor" href="#header"></a>
</h3>
<pre><code><span><span class="co">### PGS CATALOG SCORING FILE - see www.pgscatalog.org/downloads/#dl_ftp for additional information</span></span>
<span><span class="co">## POLYGENIC SCORE (PGS) INFORMATION</span></span>
<span><span class="co"># PGS ID = &lt;PGS idenfier, e.g. 'PGS000001'&gt;</span></span>
<span><span class="co"># PGS Name = &lt;PGS name, e.g. 'PRS77_BC' - optional&gt;</span></span>
<span><span class="co"># Reported Trait = &lt;trait, e.g. 'Breast Cancer'&gt;</span></span>
<span><span class="co"># Original Genome Build = &lt;Genome build/assembly, e.g. 'GRCh38'&gt;</span></span>
<span><span class="co"># Number of Variants = &lt;Number of variants listed in the PGS&gt;</span></span>
<span><span class="co">## SOURCE INFORMATION</span></span>
<span><span class="co"># PGP ID = &lt;PGS publication idenfier, e.g. 'PGP000001'&gt;</span></span>
<span><span class="co"># Citation = &lt;Information about the publication&gt;</span></span>
<span><span class="co"># LICENSE = &lt;License and terms of PGS use/distribution - refers to the EMBL-EBI Terms of Use by default&gt;</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="columns">Columns<a class="anchor" aria-label="anchor" href="#columns"></a>
</h3>
<p>The following table lists all possible columns in a PGS scoring file. A few columns are required, and most are optional; either the <code>rsID</code> alone or the combination of <code>chr_name</code> and <code>chr_position</code> are required, with the other being optional. The <code><a href="../reference/read_scoring_file.html">read_scoring_file()</a></code> function automatically reads all available columns with the right R types into a data frame.</p>
<table class="table">
<colgroup>
<col width="12%">
<col width="22%">
<col width="32%">
<col width="32%">
</colgroup>
<thead><tr class="header">
<th>Column</th>
<th>Field Name</th>
<th>Field Description</th>
<th>Field Requirement</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>rsID</code></td>
<td>dbSNP Accession ID (rsID)</td>
<td>The SNP’s rs ID</td>
<td>
<strong>Required</strong>/<strong>Optional</strong> – unless both the <em>chr_name</em> and <em>chr_position</em> columns are absent.</td>
</tr>
<tr class="even">
<td><code>chr_name</code></td>
<td>Location - Chromosome</td>
<td>Chromosome name/number associated with the variant</td>
<td>
<strong>Required</strong> – may be optional if an <em>rsID</em> for the variant is provided.</td>
</tr>
<tr class="odd">
<td><code>chr_position</code></td>
<td>Location - Position within the Chromosome</td>
<td>Chromosomal position associated with the variant</td>
<td>
<strong>Required</strong> – may be optional if an <em>rsID</em> for the variant is provided.</td>
</tr>
<tr class="even">
<td><code>effect_allele</code></td>
<td>Effect Allele</td>
<td>The allele that’s dosage is counted (e.g. {0, 1, 2}) and multiplied by the variant’s weight (‘effect_weight’) when calculating score. The effect allele is also known as the ‘risk allele’.</td>
<td><strong>Required</strong></td>
</tr>
<tr class="odd">
<td><code>reference_allele</code></td>
<td>Reference Allele</td>
<td>The other allele(s) at the loci</td>
<td>Optional – but strongly recommended.</td>
</tr>
<tr class="even">
<td><code>effect_weight</code></td>
<td>Variant Weight</td>
<td>Value of the effect that is multiplied by the dosage of the effect allele (‘effect_allele’) when calculating the score.</td>
<td><strong>Required</strong></td>
</tr>
<tr class="odd">
<td><code>locus_name</code></td>
<td>Locus Name</td>
<td>This is kept in for loci where the variant may be referenced by the gene (APOE e4). It is also common (usually in smaller PGS) to see the variants named according to the genes they impact.</td>
<td>Optional</td>
</tr>
<tr class="even">
<td><code>weight_type</code></td>
<td>Type of Weight</td>
<td>Whether the author supplied Variant Weight is a: <strong>beta</strong> (effect size), or something like an <strong>OR/HR</strong> (odds/hazard ratio)</td>
<td>Optional</td>
</tr>
<tr class="odd">
<td><code>allelefrequency_effect</code></td>
<td>Effect Allele Frequency</td>
<td>Reported effect allele frequency, if the associated locus is a haplotype then haplotype frequency will be extracted.</td>
<td>Optional</td>
</tr>
<tr class="even">
<td><code>is_interaction</code></td>
<td>FLAG: Interaction</td>
<td>This is a TRUE/FALSE variable that flags whether the weight should be multiplied with the dosage of more than one variant. Interactions are demarcated with a <em><em>x</em></em> between entries for each of the variants present in the interaction.</td>
<td>Optional</td>
</tr>
<tr class="odd">
<td><code>is_recessive</code></td>
<td>FLAG: Recessive Inheritance Model</td>
<td>This is a TRUE/FALSE variable that flags whether the weight should be added to the PGS sum only if there are 2 copies of the effect allele (e.g. it is a recessive allele).</td>
<td>Optional</td>
</tr>
<tr class="even">
<td><code>is_haplotype</code></td>
<td>FLAG: Haplotype</td>
<td>This is a TRUE/FALSE variable that flags whether the effect allele is a haplotype/diplotype rather than a single SNP. Constituent SNPs in the haplotype are semi-colon separated.</td>
<td>Optional</td>
</tr>
<tr class="odd">
<td><code>is_diplotype</code></td>
<td>FLAG: Diplotype</td>
<td>This is a TRUE/FALSE variable that flags whether the effect allele is a haplotype/diplotype rather than a single SNP. Constituent SNPs in the haplotype are semi-colon separated.</td>
<td>Optional</td>
</tr>
<tr class="even">
<td><code>imputation_method</code></td>
<td>Imputation Method</td>
<td>This described whether the variant was specifically called with a specific imputation or variant calling method. This is mostly kept to describe HLA-genotyping methods (e.g. flag SNP2HLA, HLA*IMP) that gives alleles that are not referenced by genomic position.</td>
<td>Optional</td>
</tr>
<tr class="odd">
<td><code>variant_description</code></td>
<td>Variant Description</td>
<td>This field describes any extra information about the variant (e.g. how it is genotyped or scored) that cannot be captured by the other fields.</td>
<td>Optional</td>
</tr>
<tr class="even">
<td><code>inclusion_criteria</code></td>
<td>Score Inclusion Criteria</td>
<td>Explanation of when this variant gets included into the PGS (e.g. if it depends on the results from other variants).</td>
<td>Optional</td>
</tr>
<tr class="odd">
<td><code>OR</code></td>
<td>Odds Ratio</td>
<td>Sometimes the authors only give an Odds Ratio (OR) as a weight for the PGS. In these cases the OR is turned into an <code>effect_weight</code>, by taking the log, as is customary when deriving PGS. The OR column in the scoring file to reflect how the score was originally provided by the authors.</td>
<td>Optional</td>
</tr>
<tr class="even">
<td><code>HR</code></td>
<td>Hazard Ratio</td>
<td>Sometimes the authors only give an Hazard Ratio (HR) as a weight for the PGS. In these cases the HR is turned into an <code>effect_weight</code>, by taking the log, as is customary when deriving PGS. The HR column in the scoring file to reflect how the score was originally provided by the authors.</td>
<td>Optional</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>The information here provided is gathered from the PGS Catalog documentation on the PGS scoring file schema: <a href="https://www.pgscatalog.org/downloads/" class="external-link">PGS Scoring Files</a>. Please note that, in comparison, with the original documentation of the file format, we have also included the columns <code>OR</code> and <code>HR</code> as discussed in <a href="https://github.com/PGScatalog/PGS_Catalog/issues/147" class="external-link">PGS Catalog, GitHub issue #147</a>.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by <a href="https://rmagno.eu/" class="external-link">Ramiro Magno</a>, <a href="http://iduarte.eu/" class="external-link">Isabel Duarte</a>, Ana-Teresa Maia, <a href="https://cintesis.eu/" class="external-link"><img src="reference/figures/cintesis.svg" height="24"></a>.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: '6eb557c1e1320049dc93c778f9efe639',
    indexName: 'quincunx',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
