<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PGS Catalog Entity Subsetting • quincunx</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="PGS Catalog Entity Subsetting">
<meta property="og:description" content="quincunx">
<meta property="og:image" content="https://maialab.org/quincunx/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">quincunx</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="divider">
    <li class="dropdown-header">PGS Catalog Concepts</li>
    <li>
      <a href="../articles/identifiers.html">Identifiers</a>
    </li>
    <li>
      <a href="../articles/pgs-construction-process.html">PGS Construction Process</a>
    </li>
    <li>
      <a href="../articles/cohorts-samples-sample-sets.html">Cohorts, Samples and Sample Sets</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Getting PGS Catalog Data</li>
    <li>
      <a href="../articles/getting-pgs-scores.html">Getting PGS Scores</a>
    </li>
    <li>
      <a href="../articles/getting-pgs-publications.html">Getting PGS Publications</a>
    </li>
    <li>
      <a href="../articles/getting-pgs-sample-sets.html">Getting PGS Sample Sets</a>
    </li>
    <li>
      <a href="../articles/getting-pgs-performance-metrics.html">Getting PGS Performance Metrics</a>
    </li>
    <li>
      <a href="../articles/getting-traits.html">Getting Traits</a>
    </li>
    <li>
      <a href="../articles/getting-cohorts.html">Getting Cohorts</a>
    </li>
    <li>
      <a href="../articles/getting-releases.html">PGS Catalog Releases</a>
    </li>
    <li>
      <a href="../articles/pgs-scoring-file.html">PGS scoring file</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Wrangling PGS Catalog Data</li>
    <li>
      <a href="../articles/pgs-cat-ent-subsetting.html">PGS Catalog Entity Subsetting</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Case Studies</li>
    <li>
      <a href="../articles/risk-strat-brs-patients.html">Risk of Brugada syndrome patients</a>
    </li>
    <li>
      <a href="../articles/pgs-scores-mavaddat.html">Exploring PGS scores by Mavaddat et al. (2018)</a>
    </li>
    <li class="divider">
    <li>
      <a href="../articles/index.html">More...</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
<form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="pgs-cat-ent-subsetting_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>PGS Catalog Entity Subsetting</h1>
            
      
      
      <div class="hidden name"><code>pgs-cat-ent-subsetting.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>PGS Catalog entities are represented in quincunx as S4 objects. In this article, we explain how to subset these objects using the <code><a href="https://rdrr.io/r/base/Extract.html">[</a></code> operator. In a nutshell, we provide subsetting by either position or by the object’s respective identifier. The main entities/objects are:</p>
<ul>
<li>Scores</li>
<li>Publications</li>
<li>Traits</li>
<li>Sample Sets</li>
<li>Performance Metrics</li>
</ul>
<p>The general approach to subset the various S4 objects is the same. Hence, to avoid repetition, we only provide a set of comprehensive examples for the scores object. Subsetting with the other objects is only illustrated when subsetting with identifiers to emphasise that different objects have different associated identifiers.</p>
<p>If you do not know how to subset the tables included in the S4 objects, please take a look at <a href="https://tibble.tidyverse.org/reference/subsetting.html">Subsetting tibbles</a>.</p>
<p>Start by loading quincunx:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">quincunx</span><span class="op">)</span></code></pre></div>
</div>
<div id="subsetting-scores" class="section level2">
<h2 class="hasAnchor">
<a href="#subsetting-scores" class="anchor"></a>Subsetting scores</h2>
<div id="subsetting-scores-by-position" class="section level3">
<h3 class="hasAnchor">
<a href="#subsetting-scores-by-position" class="anchor"></a>Subsetting scores by position</h3>
<p>For illustrative purposes, let us get some arbitrary polygenic scores objects, say, the first 10 PGSs in the catalog:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pgs_ids</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">'PGS%06d'</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span>
<span class="va">my_scores</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_scores.html">get_scores</a></span><span class="op">(</span><span class="va">pgs_ids</span><span class="op">)</span></code></pre></div>
<p>The object <code>my_scores</code> is an S4 object of class <code>scores</code>, see <code><a href="../reference/scores-class.html">class?scores</a></code> for details. In quincunx, each S4 object contains at least one (the first) table where each observation refers to an entity. To access tables in S4 objects you use the <code><a href="https://rdrr.io/r/base/slotOp.html">@</a></code> operator. The first table in <code>my_scores</code> is <code>scores</code>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">my_scores</span><span class="op">@</span><span class="va">scores</span>
<span class="co">#&gt; # A tibble: 10 × 12</span>
<span class="co">#&gt;    pgs_id pgs_name scoring_file matches_publica… reported_trait trait_additiona…</span>
<span class="co">#&gt;    &lt;chr&gt;  &lt;chr&gt;    &lt;chr&gt;        &lt;lgl&gt;            &lt;chr&gt;          &lt;chr&gt;           </span>
<span class="co">#&gt;  1 PGS00… PRS77_BC http://ftp.… TRUE             Breast Cancer  &lt;NA&gt;            </span>
<span class="co">#&gt;  2 PGS00… PRS77_E… http://ftp.… TRUE             ER-positive B… &lt;NA&gt;            </span>
<span class="co">#&gt;  3 PGS00… PRS77_E… http://ftp.… TRUE             ER-negative B… &lt;NA&gt;            </span>
<span class="co">#&gt;  4 PGS00… PRS313_… http://ftp.… TRUE             Breast Cancer  &lt;NA&gt;            </span>
<span class="co">#&gt;  5 PGS00… PRS313_… http://ftp.… TRUE             ER-positive B… &lt;NA&gt;            </span>
<span class="co">#&gt;  6 PGS00… PRS313_… http://ftp.… TRUE             ER-negative B… &lt;NA&gt;            </span>
<span class="co">#&gt;  7 PGS00… PRS3820… http://ftp.… TRUE             Breast Cancer  &lt;NA&gt;            </span>
<span class="co">#&gt;  8 PGS00… PRS3820… http://ftp.… TRUE             ER-positive B… &lt;NA&gt;            </span>
<span class="co">#&gt;  9 PGS00… PRS3820… http://ftp.… TRUE             ER-negative B… &lt;NA&gt;            </span>
<span class="co">#&gt; 10 PGS00… GRS27    http://ftp.… TRUE             Coronary hear… &lt;NA&gt;            </span>
<span class="co">#&gt; # … with 6 more variables: pgs_method_name &lt;chr&gt;, pgs_method_params &lt;chr&gt;,</span>
<span class="co">#&gt; #   n_variants &lt;int&gt;, n_variants_interactions &lt;int&gt;, assembly &lt;chr&gt;,</span>
<span class="co">#&gt; #   license &lt;chr&gt;</span>

<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">my_scores</span><span class="op">@</span><span class="va">scores</span><span class="op">)</span>
<span class="co">#&gt; [1] 10</span></code></pre></div>
<p>This table has as many rows as polygenic scores. This is one way of knowing how many scores there are in the object. Alternatively, you can use the function <code><a href="../reference/n.html">n()</a></code> on the object:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/n.html">n</a></span><span class="op">(</span><span class="va">my_scores</span><span class="op">)</span>
<span class="co">#&gt; [1] 10</span></code></pre></div>
<p>It is important to know the number of scores if you plan to subset the <code>my_scores</code> object by position. In this case there are 10 scores. If you want to subset the first, fifth, and tenth score, then you could do:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">my_scores</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span>, <span class="fl">10</span><span class="op">)</span><span class="op">]</span><span class="op">@</span><span class="va">scores</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>
<span class="co">#&gt; # A tibble: 3 × 2</span>
<span class="co">#&gt;   pgs_id    pgs_name    </span>
<span class="co">#&gt;   &lt;chr&gt;     &lt;chr&gt;       </span>
<span class="co">#&gt; 1 PGS000001 PRS77_BC    </span>
<span class="co">#&gt; 2 PGS000005 PRS313_ERpos</span>
<span class="co">#&gt; 3 PGS000010 GRS27</span></code></pre></div>
<p>This returns a new object containing only the data for the scores <code>"PGS000001"</code>, <code>"PGS000005"</code> and <code>"PGS000010"</code>.</p>
<p>Notice that this operation automatically traverses all tables in the <code>my_scores</code> object and subsets all tables accordingly keeping only those rows corresponding to the first, fifth and tenth scores. For example, compare the table <code>samples</code> from the <code>my_scores</code> object before and after the subsetting.</p>
<p>Before subsetting:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">my_scores</span><span class="op">@</span><span class="va">samples</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>
<span class="co">#&gt; # A tibble: 22 × 4</span>
<span class="co">#&gt;    pgs_id    sample_id stage sample_size</span>
<span class="co">#&gt;    &lt;chr&gt;         &lt;int&gt; &lt;chr&gt;       &lt;int&gt;</span>
<span class="co">#&gt;  1 PGS000001         1 gwas        22627</span>
<span class="co">#&gt;  2 PGS000002         1 gwas        22627</span>
<span class="co">#&gt;  3 PGS000003         1 gwas        22627</span>
<span class="co">#&gt;  4 PGS000004         1 gwas       139274</span>
<span class="co">#&gt;  5 PGS000004         2 dev        158648</span>
<span class="co">#&gt;  6 PGS000004         3 dev         10444</span>
<span class="co">#&gt;  7 PGS000005         1 gwas       139274</span>
<span class="co">#&gt;  8 PGS000005         2 dev         87368</span>
<span class="co">#&gt;  9 PGS000005         3 dev          5159</span>
<span class="co">#&gt; 10 PGS000006         1 gwas       139274</span>
<span class="co">#&gt; # … with 12 more rows</span></code></pre></div>
<p>After subsetting with <code><a href="https://rdrr.io/r/base/c.html">c(1, 5, 10)</a></code>:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">my_scores</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span>, <span class="fl">10</span><span class="op">)</span><span class="op">]</span><span class="op">@</span><span class="va">samples</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>
<span class="co">#&gt; # A tibble: 5 × 4</span>
<span class="co">#&gt;   pgs_id    sample_id stage sample_size</span>
<span class="co">#&gt;   &lt;chr&gt;         &lt;int&gt; &lt;chr&gt;       &lt;int&gt;</span>
<span class="co">#&gt; 1 PGS000001         1 gwas        22627</span>
<span class="co">#&gt; 2 PGS000005         1 gwas       139274</span>
<span class="co">#&gt; 3 PGS000005         2 dev         87368</span>
<span class="co">#&gt; 4 PGS000005         3 dev          5159</span>
<span class="co">#&gt; 5 PGS000010         1 gwas        86995</span></code></pre></div>
</div>
<div id="subsetting-scores-by-identifer" class="section level3">
<h3 class="hasAnchor">
<a href="#subsetting-scores-by-identifer" class="anchor"></a>Subsetting scores by identifer</h3>
<p>To subset by identifier you simply use a character vector with the identifiers of interest. Let us say now you want two identifiers: <code>"PGS000002"</code> and <code>"PGS000008"</code>. Then only you need to do is:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">my_scores</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'PGS000002'</span>, <span class="st">'PGS000008'</span><span class="op">)</span><span class="op">]</span><span class="op">@</span><span class="va">scores</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>
<span class="co">#&gt; # A tibble: 2 × 2</span>
<span class="co">#&gt;   pgs_id    pgs_name     </span>
<span class="co">#&gt;   &lt;chr&gt;     &lt;chr&gt;        </span>
<span class="co">#&gt; 1 PGS000002 PRS77_ERpos  </span>
<span class="co">#&gt; 2 PGS000008 PRS3820_ERpos</span></code></pre></div>
</div>
<div id="subsetting-using-repeated-positions-or-identifiers" class="section level3">
<h3 class="hasAnchor">
<a href="#subsetting-using-repeated-positions-or-identifiers" class="anchor"></a>Subsetting using repeated positions or identifiers</h3>
<p>Please note that if you repeat the same position or identifier, you will get that score repeated:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">my_scores</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'PGS000003'</span>, <span class="st">'PGS000003'</span><span class="op">)</span><span class="op">]</span><span class="op">@</span><span class="va">scores</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>
<span class="co">#&gt; # A tibble: 2 × 2</span>
<span class="co">#&gt;   pgs_id    pgs_name   </span>
<span class="co">#&gt;   &lt;chr&gt;     &lt;chr&gt;      </span>
<span class="co">#&gt; 1 PGS000003 PRS77_ERneg</span>
<span class="co">#&gt; 2 PGS000003 PRS77_ERneg</span>

<span class="fu"><a href="../reference/n.html">n</a></span><span class="op">(</span><span class="va">my_scores</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'PGS000003'</span>, <span class="st">'PGS000003'</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt; [1] 2</span></code></pre></div>
<p>Or using the third position twice:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">my_scores</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span><span class="op">]</span><span class="op">@</span><span class="va">scores</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>
<span class="co">#&gt; # A tibble: 2 × 2</span>
<span class="co">#&gt;   pgs_id    pgs_name   </span>
<span class="co">#&gt;   &lt;chr&gt;     &lt;chr&gt;      </span>
<span class="co">#&gt; 1 PGS000003 PRS77_ERneg</span>
<span class="co">#&gt; 2 PGS000003 PRS77_ERneg</span>

<span class="fu"><a href="../reference/n.html">n</a></span><span class="op">(</span><span class="va">my_scores</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt; [1] 2</span></code></pre></div>
</div>
<div id="subsetting-using-negative-positions" class="section level3">
<h3 class="hasAnchor">
<a href="#subsetting-using-negative-positions" class="anchor"></a>Subsetting using negative positions</h3>
<p>Just like with basic R objects, we can also use negative indices to drop elements of an object. This is also supported with quincunx’s S4 objects. For example, to drop now the first, fifth and tenth score:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Notice the minus sign before c(1, 5, 10)</span>
<span class="va">my_scores</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span>, <span class="fl">10</span><span class="op">)</span><span class="op">]</span><span class="op">@</span><span class="va">scores</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>
<span class="co">#&gt; # A tibble: 7 × 2</span>
<span class="co">#&gt;   pgs_id    pgs_name     </span>
<span class="co">#&gt;   &lt;chr&gt;     &lt;chr&gt;        </span>
<span class="co">#&gt; 1 PGS000002 PRS77_ERpos  </span>
<span class="co">#&gt; 2 PGS000003 PRS77_ERneg  </span>
<span class="co">#&gt; 3 PGS000004 PRS313_BC    </span>
<span class="co">#&gt; 4 PGS000006 PRS313_ERneg </span>
<span class="co">#&gt; 5 PGS000007 PRS3820_BC   </span>
<span class="co">#&gt; 6 PGS000008 PRS3820_ERpos</span>
<span class="co">#&gt; 7 PGS000009 PRS3820_ERneg</span></code></pre></div>
</div>
<div id="subsetting-with-non-existing-positions-or-identifiers" class="section level3">
<h3 class="hasAnchor">
<a href="#subsetting-with-non-existing-positions-or-identifiers" class="anchor"></a>Subsetting with non-existing positions or identifiers</h3>
<p>If you request a position or identifier that does not match in the object, the result is an empty object. For example, the 11th position is not present in <code>my_scores</code> so the returned object is empty:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">my_scores</span><span class="op">[</span><span class="fl">11</span><span class="op">]</span><span class="op">@</span><span class="va">scores</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>
<span class="co">#&gt; # A tibble: 0 × 2</span>
<span class="co">#&gt; # … with 2 variables: pgs_id &lt;chr&gt;, pgs_name &lt;chr&gt;</span>

<span class="fu"><a href="../reference/n.html">n</a></span><span class="op">(</span><span class="va">my_scores</span><span class="op">[</span><span class="fl">11</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt; [1] 0</span></code></pre></div>
<p>Please note that the returned object is still a valid <code>scores</code> object and that it contains all the expected tables of such an object. It is just that all tables have no rows. The same behaviour is to be expected if you try to subset with non-existing identifiers:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">my_scores</span><span class="op">[</span><span class="st">'PGS000011'</span><span class="op">]</span><span class="op">@</span><span class="va">scores</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>
<span class="co">#&gt; # A tibble: 0 × 2</span>
<span class="co">#&gt; # … with 2 variables: pgs_id &lt;chr&gt;, pgs_name &lt;chr&gt;</span>

<span class="fu"><a href="../reference/n.html">n</a></span><span class="op">(</span><span class="va">my_scores</span><span class="op">[</span><span class="st">'PGS000011'</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt; [1] 0</span></code></pre></div>
</div>
</div>
<div id="subsetting-publications" class="section level2">
<h2 class="hasAnchor">
<a href="#subsetting-publications" class="anchor"></a>Subsetting Publications</h2>
<p>Subsetting publications objects, or any other S4 object in quincunx, works exactly the same way as described for scores. The only difference is that identifiers have to be changed accordingly. So in the next sections we only show how to subset using the respective identifiers.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Get all publications where Abraham G is an author</span>
<span class="va">my_publ</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_publications.html">get_publications</a></span><span class="op">(</span>author <span class="op">=</span> <span class="st">'Abraham G'</span><span class="op">)</span>

<span class="co"># Note that the column `author_fullname` corresponds to the first author.</span>
<span class="va">my_publ</span><span class="op">@</span><span class="va">publications</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'pgp_id'</span>, <span class="st">'pubmed_id'</span>, <span class="st">'publication_date'</span>, <span class="st">'author_fullname'</span><span class="op">)</span><span class="op">]</span>
<span class="co">#&gt; # A tibble: 7 × 4</span>
<span class="co">#&gt;   pgp_id    pubmed_id publication_date author_fullname</span>
<span class="co">#&gt;   &lt;chr&gt;     &lt;chr&gt;     &lt;date&gt;           &lt;chr&gt;          </span>
<span class="co">#&gt; 1 PGP000005 27655226  2016-09-21       Abraham G      </span>
<span class="co">#&gt; 2 PGP000007 30309464  2018-10-01       Inouye M       </span>
<span class="co">#&gt; 3 PGP000027 31862893  2019-12-20       Abraham G      </span>
<span class="co">#&gt; 4 PGP000028 24550740  2014-02-13       Abraham G      </span>
<span class="co">#&gt; 5 PGP000029 26244058  2015-07-16       Abraham G      </span>
<span class="co">#&gt; 6 PGP000052 32887683  2020-09-04       Cánovas R      </span>
<span class="co">#&gt; 7 PGP000137 &lt;NA&gt;      2019-12-19       Ritchie SC</span></code></pre></div>
<p>By visual inspection we can see that Abraham G is the first author in PGP000005, PGP000027, PGP000028, and PGP000029.</p>
<p>To keep only those publications we subset the publication object <code>my_publ</code> by those PGP identifiers:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">my_publ</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'PGP000005'</span>, <span class="st">'PGP000027'</span>, <span class="st">'PGP000028'</span>, <span class="st">'PGP000029'</span><span class="op">)</span><span class="op">]</span><span class="op">@</span><span class="va">publications</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'pgp_id'</span>, <span class="st">'pubmed_id'</span>, <span class="st">'publication_date'</span>, <span class="st">'author_fullname'</span><span class="op">)</span><span class="op">]</span>
<span class="co">#&gt; # A tibble: 4 × 4</span>
<span class="co">#&gt;   pgp_id    pubmed_id publication_date author_fullname</span>
<span class="co">#&gt;   &lt;chr&gt;     &lt;chr&gt;     &lt;date&gt;           &lt;chr&gt;          </span>
<span class="co">#&gt; 1 PGP000005 27655226  2016-09-21       Abraham G      </span>
<span class="co">#&gt; 2 PGP000027 31862893  2019-12-20       Abraham G      </span>
<span class="co">#&gt; 3 PGP000028 24550740  2014-02-13       Abraham G      </span>
<span class="co">#&gt; 4 PGP000029 26244058  2015-07-16       Abraham G</span></code></pre></div>
</div>
<div id="subsetting-traits" class="section level2">
<h2 class="hasAnchor">
<a href="#subsetting-traits" class="anchor"></a>Subsetting Traits</h2>
<p>To illustrate subsetting of a traits object with EFO identifiers, let us say you’d like to create a traits object with traits whose trait name contained the keyword <code>"lymph"</code>. To do this, we will start by downloading all traits into a traits object. Then we look for the term <code>"lymph"</code> in the <code>trait</code> column, and find which EFO identifiers are matched. Finally, we will use those identifiers to create a traits object containing only those matched identifiers.</p>
<p>Get all traits:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">all_traits</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_traits.html">get_traits</a></span><span class="op">(</span>interactive <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p>Find which traits have in their name (<code>trait</code> column of <code>traits</code> table) the term <code>"lymph"</code> (we use <code>grep</code> for this):</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lymph_traits_positions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">grep</a></span><span class="op">(</span><span class="st">'lymph'</span>, <span class="va">all_traits</span><span class="op">@</span><span class="va">traits</span><span class="op">$</span><span class="va">trait</span><span class="op">)</span>

<span class="va">all_traits</span><span class="op">[</span><span class="va">lymph_traits_positions</span><span class="op">]</span><span class="op">@</span><span class="va">traits</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'efo_id'</span>, <span class="st">'trait'</span><span class="op">)</span><span class="op">]</span>
<span class="co">#&gt; # A tibble: 7 × 2</span>
<span class="co">#&gt;   efo_id        trait                              </span>
<span class="co">#&gt;   &lt;chr&gt;         &lt;chr&gt;                              </span>
<span class="co">#&gt; 1 EFO_0000095   chronic lymphocytic leukemia       </span>
<span class="co">#&gt; 2 MONDO_0018906 follicular lymphoma                </span>
<span class="co">#&gt; 3 EFO_0000183   Hodgkins lymphoma                  </span>
<span class="co">#&gt; 4 EFO_0004587   lymphocyte count                   </span>
<span class="co">#&gt; 5 EFO_0007993   lymphocyte percentage of leukocytes</span>
<span class="co">#&gt; 6 EFO_0004289   lymphoid leukemia                  </span>
<span class="co">#&gt; 7 EFO_0005952   non-Hodgkins lymphoma</span></code></pre></div>
<p>Select only those EFO identifiers whose trait name contained <code>"lymph"</code>:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">my_efo_ids</span> <span class="op">&lt;-</span> <span class="va">all_traits</span><span class="op">[</span><span class="va">lymph_traits_positions</span><span class="op">]</span><span class="op">@</span><span class="va">traits</span><span class="op">$</span><span class="va">efo_id</span>
<span class="va">my_efo_ids</span>
<span class="co">#&gt; [1] "EFO_0000095"   "MONDO_0018906" "EFO_0000183"   "EFO_0004587"  </span>
<span class="co">#&gt; [5] "EFO_0007993"   "EFO_0004289"   "EFO_0005952"</span></code></pre></div>
<p>Finally, create a new traits object (<code>traits_only_lymph</code>) with only those traits matching <code>"lymph"</code> by subsetting by identifier:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">traits_only_lymph</span> <span class="op">&lt;-</span> <span class="va">all_traits</span><span class="op">[</span><span class="va">my_efo_ids</span><span class="op">]</span></code></pre></div>
<p>Confirm that indeed only those traits with <code>"lymph"</code> in the name are present:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">traits_only_lymph</span><span class="op">@</span><span class="va">traits</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">4</span><span class="op">)</span><span class="op">]</span>
<span class="co">#&gt; # A tibble: 7 × 2</span>
<span class="co">#&gt;   efo_id        trait                              </span>
<span class="co">#&gt;   &lt;chr&gt;         &lt;chr&gt;                              </span>
<span class="co">#&gt; 1 EFO_0000095   chronic lymphocytic leukemia       </span>
<span class="co">#&gt; 2 MONDO_0018906 follicular lymphoma                </span>
<span class="co">#&gt; 3 EFO_0000183   Hodgkins lymphoma                  </span>
<span class="co">#&gt; 4 EFO_0004587   lymphocyte count                   </span>
<span class="co">#&gt; 5 EFO_0007993   lymphocyte percentage of leukocytes</span>
<span class="co">#&gt; 6 EFO_0004289   lymphoid leukemia                  </span>
<span class="co">#&gt; 7 EFO_0005952   non-Hodgkins lymphoma</span></code></pre></div>
<p>You might have noticed that we could have used <code>lymph_traits_positions</code> to subset <code>all_traits</code> by position instead to the same effect. That would have been more straightforward, but the point here is to illustrate subsetting with EFO identifiers. Moreover, as an exercise, you might want to compare the results obtained with this example with:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Get traits containing the term 'lymph' in the name or its description</span>
<span class="fu"><a href="../reference/get_traits.html">get_traits</a></span><span class="op">(</span>trait_term <span class="op">=</span> <span class="st">'lymph'</span>, exact_term <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>

<span class="co"># Get traits whose name is exactly 'lymph'</span>
<span class="fu"><a href="../reference/get_traits.html">get_traits</a></span><span class="op">(</span>trait_term <span class="op">=</span> <span class="st">'lymph'</span>, exact_term <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
</div>
<div id="subsetting-sample-sets" class="section level2">
<h2 class="hasAnchor">
<a href="#subsetting-sample-sets" class="anchor"></a>Subsetting Sample Sets</h2>
<p>To subset PGS Sample Sets you use identifiers of the form: <code>"PSS000000"</code>. Here’s a simple example where we download two Sample Sets (<code>"PSS000008"</code> and <code>"PSS000042"</code>), and afterwards we take <code>"PSS000008"</code>:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">my_sample_sets</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_sample_sets.html">get_sample_sets</a></span><span class="op">(</span>pss_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'PSS000008'</span>, <span class="st">'PSS000042'</span><span class="op">)</span><span class="op">)</span>

<span class="co"># Table `samples` contains the samples that comprise this Sample Set</span>
<span class="va">my_sample_sets</span><span class="op">[</span><span class="st">'PSS000008'</span><span class="op">]</span><span class="op">@</span><span class="va">samples</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span>
<span class="co">#&gt; # A tibble: 3 × 6</span>
<span class="co">#&gt;   pss_id    sample_id stage sample_size sample_cases sample_controls</span>
<span class="co">#&gt;   &lt;chr&gt;         &lt;int&gt; &lt;chr&gt;       &lt;int&gt;        &lt;int&gt;           &lt;int&gt;</span>
<span class="co">#&gt; 1 PSS000008         1 eval         6978          149            6829</span>
<span class="co">#&gt; 2 PSS000008         2 eval        27271           NA              NA</span>
<span class="co">#&gt; 3 PSS000008         3 eval         8749          108            8641</span></code></pre></div>
</div>
<div id="subsetting-performance-metrics" class="section level2">
<h2 class="hasAnchor">
<a href="#subsetting-performance-metrics" class="anchor"></a>Subsetting Performance Metrics</h2>
<p>Without much more creativity, you subset Performance Metrics objects with identifiers of the form: <code>"PPM000000"</code>. Example:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">my_perf_metrics</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_performance_metrics.html">get_performance_metrics</a></span><span class="op">(</span>ppm_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'PPM000001'</span>, <span class="st">'PPM000002'</span><span class="op">)</span><span class="op">)</span>

<span class="co"># Table `samples` contains the samples that comprise this Performance Metrics</span>
<span class="va">my_perf_metrics</span><span class="op">[</span><span class="st">'PPM000002'</span><span class="op">]</span><span class="op">@</span><span class="va">samples</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span>
<span class="co">#&gt; # A tibble: 1 × 6</span>
<span class="co">#&gt;   ppm_id    pss_id    sample_id stage sample_size sample_cases</span>
<span class="co">#&gt;   &lt;chr&gt;     &lt;chr&gt;         &lt;int&gt; &lt;chr&gt;       &lt;int&gt;        &lt;int&gt;</span>
<span class="co">#&gt; 1 PPM000002 PSS000003         1 eval        53923        21365</span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://rmagno.eu/">Ramiro Magno</a>, <a href="https://iduarte.eu/">Isabel Duarte</a>, Ana-Teresa Maia, Centre for Biomedical Research, University of Algarve.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: '6eb557c1e1320049dc93c778f9efe639',
    indexName: 'quincunx',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
