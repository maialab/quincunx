<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>quincunx vs REST API direct access • quincunx</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="quincunx vs REST API direct access">
<meta property="og:description" content="quincunx">
<meta property="og:image" content="https://maialab.org/quincunx/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">quincunx</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="divider">
    </li>
<li class="dropdown-header">PGS Catalog Concepts</li>
    <li>
      <a href="../articles/identifiers.html">Identifiers</a>
    </li>
    <li>
      <a href="../articles/pgs-construction-process.html">PGS Construction Process and Stages</a>
    </li>
    <li>
      <a href="../articles/cohorts-samples-sample-sets.html">Cohorts, Samples and Sample Sets</a>
    </li>
    <li class="divider">
    </li>
<li class="dropdown-header">Getting PGS Catalog Data</li>
    <li>
      <a href="../articles/getting-pgs-scores.html">Getting PGS Scores</a>
    </li>
    <li>
      <a href="../articles/getting-pgs-publications.html">Getting PGS Publications</a>
    </li>
    <li>
      <a href="../articles/getting-pgs-sample-sets.html">Getting PGS Sample Sets</a>
    </li>
    <li>
      <a href="../articles/getting-pgs-performance-metrics.html">Getting PGS Performance Metrics</a>
    </li>
    <li>
      <a href="../articles/getting-traits.html">Getting Traits</a>
    </li>
    <li>
      <a href="../articles/getting-cohorts.html">Getting Cohorts</a>
    </li>
    <li>
      <a href="../articles/getting-releases.html">PGS Catalog Releases</a>
    </li>
    <li>
      <a href="../articles/pgs-scoring-file.html">PGS scoring file</a>
    </li>
    <li class="divider">
    </li>
<li class="dropdown-header">Wrangling PGS Catalog Data</li>
    <li>
      <a href="../articles/pgs-cat-ent-subsetting.html">PGS Catalog Entity Subsetting</a>
    </li>
    <li class="divider">
    </li>
<li class="dropdown-header">Case Studies</li>
    <li>
      <a href="../articles/risk-strat-brs-patients.html">Risk of Brugada syndrome patients</a>
    </li>
    <li>
      <a href="../articles/pgs-scores-mavaddat.html">Exploring PGS scores by Mavaddat et al. (2018)</a>
    </li>
    <li class="divider">
    </li>
<li>
      <a href="../articles/index.html">More articles...</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/maialab/quincunx/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="quincunx-s-advantages_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>quincunx vs REST API direct access</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/maialab/quincunx/blob/HEAD/vignettes/quincunx-s-advantages.Rmd" class="external-link"><code>vignettes/quincunx-s-advantages.Rmd</code></a></small>
      <div class="hidden name"><code>quincunx-s-advantages.Rmd</code></div>

    </div>

    
    
<p>In this vignette we provided a set of advantages to using quincunx when compared to a direct access of the PGS Catalog REST API.</p>
<div class="section level2">
<h2 id="handling-of-lower-level-tasks">Handling of lower-level tasks<a class="anchor" aria-label="anchor" href="#handling-of-lower-level-tasks"></a>
</h2>
<p>quincunx automatically handles lower-level tasks related to the GET requests, such as pagination and handling of errors. When a user of quincunx calls a <code>get functions</code>, .e.g, <code><a href="../reference/get_scores.html">get_scores()</a></code>, this will translate to GET requests on one of the following endpoints: <code>/rest/score/all</code>, <code>/rest/score/{pgs_id}</code>, or <code>/rest/score/search</code>. The first and last endpoints return paginated JSON responses, meaning that we need logic on the client side that iterates over all the paginated resources, making the respective GET requests such that all the data is fetched. quincunx automatically detects if the endpoint is returning a paginated response or not (because it is not always paginated), and iterates automatically. Also, quincunx’s <code>get functions</code> gracefully handle http errors that might arise along the process, not breaking the execution, and collecting the data from those responses that were successful, while generating warnings for those that failed. Moreover, user control is offered on these warnings, and a verbose flag is also provided in our functions for easy debugging of the underlying requests. All these are menial features that, nevertheless, are important for a smooth usage of the REST API.</p>
</div>
<div class="section level2">
<h2 id="endpoint-abstraction">Endpoint abstraction<a class="anchor" aria-label="anchor" href="#endpoint-abstraction"></a>
</h2>
<p>quincunx’s set of <code>get_&lt;entity&gt;()</code> functions provide an API that abstracts away the REST API endpoint construction and that best matches user expectations, i.e., one <code>get</code> function for each type of Catalog entity. For example, a quincunx’s user only needs to know the <code><a href="../reference/get_scores.html">get_scores()</a></code> to retrieve metadata about Polygenic Scores. A more direct access to the REST API implies knowing the three endpoints and how to pass them their parameters. Also, by having one function for all related endpoints, this means that we can provide a single interface for all search criteria. For example, in the case of <code><a href="../reference/get_scores.html">get_scores()</a></code>, the user may search by PGS identifier (<code>pgs_id</code>), Trait id (<code>efo_id</code>) or by PubMed id (<code>pubmed_id</code>), or even get all polygenic scores by not supplying any criteria. quincunx’s accepts all these options in a single interface, and provides an extra argument (<code>set_operation</code>) on how to combine the results obtained with the different criteria. Without a client like quincunx all of this logic would have to be implemented anew.</p>
</div>
<div class="section level2">
<h2 id="automatic-json-deserialization">Automatic JSON deserialization<a class="anchor" aria-label="anchor" href="#automatic-json-deserialization"></a>
</h2>
<p>Retrieving data from a REST API to an environment, such as the R programming language, requires the conversion of JSON text into R objects, i.e., JSON deserialization. Here, we hinge on the R package <a href="https://github.com/colearendt/tidyjson" class="external-link">tidyjson</a>. Some other more direct access method to the REST API would require the users to either learn to use a similar tool or implement it themselves.</p>
</div>
<div class="section level2">
<h2 id="relational-database-representation-of-catalog-entities">Relational database representation of Catalog entities<a class="anchor" aria-label="anchor" href="#relational-database-representation-of-catalog-entities"></a>
</h2>
<p>Most importantly, besides JSON deserialization, we chose to represent each Catalog entity as a relational database (quincunx’s S4 objects). This does not follow automatically from the data structure in the JSON responses. This process required careful analysis of the Catalog data and of the relationships between the different data structures, since this information is not explicit in the Catalog documentation. Specifically, we partly reverse engineered by studying the JSON responses and frequently communicated with the Catalog team during the development of our package.</p>
</div>
<div class="section level2">
<h2 id="tidyverse-friendly-for-easy-data-wrangling-and-visualisation">Tidyverse friendly for easy data wrangling and visualisation<a class="anchor" aria-label="anchor" href="#tidyverse-friendly-for-easy-data-wrangling-and-visualisation"></a>
</h2>
<p>The actual implementation of the in-memory relational databases based on lists of tibbles provides a commonly used interface in the R community nowadays, i.e., the use of so-called tidy data, which allows taking advantage of the <a href="https://www.tidyverse.org/" class="external-link">tidyverse</a> toolkit for direct data analysis/modeling and visualization, e.g. with <a href="https://ggplot2.tidyverse.org/" class="external-link">ggplot2</a>.</p>
</div>
<div class="section level2">
<h2 id="variable-name-harmonisation">Variable name harmonisation<a class="anchor" aria-label="anchor" href="#variable-name-harmonisation"></a>
</h2>
<p>Each table in quincunx’s relational databases is not simply an automatic result of the parsing of the JSON responses. The majority of the column names have been unified to follow a common naming scheme and, whenever possible, simplified to better communicate their biological meaning. For example, in nearly all JSON responses, there is an <code>id</code> element, which, depending on the endpoint, can stand for PGS id, PGP id, PSS id, PPM id, Trait id, etc.; in quincunx, these have been aptly mapped to <code>pgs_id</code>, <code>pgp_id</code>, <code>pss_id</code>, <code>ppm_id</code> or <code>efo_id</code> for clarity and to prevent <code>id</code> mistakes. Moreover, new identifiers have been created in quincunx’s objects, allowing the connection of information between tables. These new identifiers are indicated as having a “local” scope (see <code><a href="../articles/identifiers.html">vignette('identifiers')</a></code>.</p>
</div>
<div class="section level2">
<h2 id="correct-variable-type-coercion">Correct variable type coercion<a class="anchor" aria-label="anchor" href="#correct-variable-type-coercion"></a>
</h2>
<p>Basic data types, such as booleans, strings, integers and doubles are correctly mapped to R’s equivalent basic types in quincunx’s tables. Note that in JSON there is no distinction between integers and doubles, an ambiguity that can only be resolved by analysis of the data variables’ meaning. Also, various representations of missing data (e.g., <code>"NR"</code>, <code>"Not Reported"</code>, <code>null</code>, <code>""</code>, etc.) are correctly mapped to <code>NA</code> in R. In the case of <code>null</code> JSON objects that have a nested schema, the corresponding relational tables are recreated with the correct columns and types (albeit empty) so that the scripts do not break. This data structure consistency is an important feature allowing posterior data wrangling, such as combination of results that have the same structure. So although our tables inside the S4 objects might seem raw, they are actually the result of data tidying and cleaning, and of reverse engineering of the relationships between objects such that they can be made into relational tables.</p>
</div>
<div class="section level2">
<h2 id="database-level-subsetting-of-tables">Database level subsetting of tables<a class="anchor" aria-label="anchor" href="#database-level-subsetting-of-tables"></a>
</h2>
<p>A very useful feature of our S4 objects is the subsetting based on indices or identifiers. Moreover, subsetting quincunx’s objects conveniently permeates to all tables (slots).</p>
</div>
<div class="section level2">
<h2 id="part-of-the-hapiverse">Part of the hapiverse<a class="anchor" aria-label="anchor" href="#part-of-the-hapiverse"></a>
</h2>
<p>quincunx’s is a sibling package of <a href="https://github.com/ramiromagno/gwasrapidd/" class="external-link">gwasrapidd</a>— providing access to the GWAS Catalog—, and incorporates the same design principles, particularly when it comes to the data representation and wrangling. So users working in this field that have already used one of the tools, will see their knowledge easily transferred to the other one.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by <a href="https://rmagno.eu/" class="external-link">Ramiro Magno</a>, <a href="http://iduarte.eu/" class="external-link">Isabel Duarte</a>, Ana-Teresa Maia, <a href="https://cintesis.eu/" class="external-link"><img src="reference/figures/cintesis.svg" height="24"></a>.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: '6eb557c1e1320049dc93c778f9efe639',
    indexName: 'quincunx',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
